(function () {function k(e,n,t,i,r,o,s){try{var a=e[o](s),c=a.value}catch(p){return void t(p)}a.done?n(c):Promise.resolve(c).then(i,r)}function m(e){return function(){var n=this,t=arguments;return new Promise(function(i,r){var o=e.apply(n,t);function s(e){k(o,i,r,s,a,"next",e)}function a(e){k(o,i,r,s,a,"throw",e)}s(void 0)})}}function l(e,t,n,r,o,s,i){try{var a=e[s](i),p=a.value}catch($){return void n($)}a.done?t(p):Promise.resolve(p).then(r,o)}function q(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var s=e.apply(t,n);function i(e){l(s,r,o,i,a,"next",e)}function a(e){l(s,r,o,i,a,"throw",e)}i(void 0)})}}var d={props:{item:function(){return{type:Object,default:{}}}},computed:{itemlink:function(){return"archive.org"==this.item.type?this.item.data.url:this.item.target},itemclass:function(){return"archive.org"==this.item.type?"k-list-item-sendmentions-sent k-list-item-sendmentions-archiveorg":"pingback"==this.item.type||"webmention"==this.item.type?"k-list-item-sendmentions-sent":"notsent"==this.item.type?"k-list-item-sendmentions-notsent":"k-list-item-sendmentions-failed"},type_formatted:function(){switch(this.item.type){case"none":return"no endpoint";case"notsent":return"not pinged";case"webmention":return this.item.type+" ("+this.item.data.response+")";default:return this.item.type;}},buttonicon:function(){return"archive.org"===this.item.type?"":"notsent"===this.item.type?"angle-right":"refresh"},icon:function(){switch(this.item.type){case"webmention":return"sendmentions-webmention";case"pingback":return"globe";case"archive.org":return"sendmentions-archiveorg";case"none":return"cancel";default:return"circle-outline";}}}};if(typeof d==="function"){d=d.options}Object.assign(d,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("li",{staticClass:"k-list-item",class:_vm.itemclass},[_c("div",{staticClass:"k-list-item-content"},[_c("a",{staticClass:"k-link k-list-item-content",attrs:{"href":_vm.itemlink,"target":"_blank"}},[_c("span",{staticClass:"k-list-item-image"},[_c("k-icon",{attrs:{"type":_vm.icon}})],1),_vm._v(" "),_c("span",{staticClass:"k-list-item-text"},[_c("em",{domProps:{"innerHTML":_vm._s(_vm.item.target)}}),_vm._v(" "),_c("small",{domProps:{"innerHTML":_vm._s(_vm.type_formatted)}})])])]),_vm._v(" "),_c("nav",{staticClass:"k-list-item-options"},[_c("k-button",{attrs:{"tooltip":_vm.$t("send"),"icon":_vm.buttonicon,"alt":_vm.Send},on:{"click":function($event){$event.stopPropagation();return _vm.$emit("action","resend",_vm.item)}}})],1)])};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());var f={};if(typeof f==="function"){f=f.options}Object.assign(f,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("ul",{staticClass:"k-list"},[_vm._t("default")],2)};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());var g={components:{"k-sendmentions-list":f,"k-sendmentions-item":d},data:function(){return{sendmentions:[],empty:null}},methods:{open:function(e,t){this.sendmentions=e,this.empty=t,this.$refs.dialog.open()},submit:function(){this.$refs.dialog.close()},action:function(e,t){"resend"===e&&this.resend(t.pageid,t.target,t.type)},resend:function(e,t,n){var r=this;return q(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:console.log(e+t+n),"sendmentions/"+e.replace(/\//,"+"),r.$store.dispatch("notification/success",":)");case 3:case"end":return o.stop();}},o)}))()}}};if(typeof g==="function"){g=g.options}Object.assign(g,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("k-dialog",{ref:"dialog",staticClass:"k-sendmentions-detailsdialog",attrs:{"button":_vm.$t("Done"),"size":"large","theme":"positive"},on:{"submit":_vm.submit}},[_vm.sendmentions.length>0?_c("k-sendmentions-list",_vm._l(_vm.sendmentions,function(item){return _c("k-sendmentions-item",{key:item.uid,attrs:{"item":item},on:{"action":_vm.action}})}),1):_c("k-empty",{attrs:{"layout":"list","icon":"globe"}},[_vm._v(" "+_vm._s(_vm.empty)+" ")])],1)};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());var h={};if(typeof h==="function"){h=h.options}Object.assign(h,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("div",{staticClass:"k-grid k-sendmentions-pagesettings"},[_vm._t("default")],2)};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());var j={props:{setting:Object},computed:{label:function(){return Array.isArray(this.setting.text)?this.setting.value?this.setting.text[0]:this.setting.text[1]:this.setting.text}},methods:{change:function(t){this.setting.value=t,this.$emit("change",this.setting.id,t)}}};if(typeof j==="function"){j=j.options}Object.assign(j,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("div",{staticClass:"k-column",attrs:{"data-width":"1/1"}},[_c("div",{staticClass:"k-toggle-field k-field"},[_c("div",{staticClass:"k-input",attrs:{"data-theme":"field","data-type":"toggle"}},[_c("span",{staticClass:"k-input-element"},[_c("label",{staticClass:"k-toggle-input",attrs:{"data-disabled":_vm.setting.disabled}},[_c("input",{ref:"input",staticClass:"k-toggle-input-native",attrs:{"id":_vm.setting.id,"disabled":_vm.setting.disabled,"type":"checkbox"},domProps:{"checked":_vm.setting.value},on:{"change":function($event){return _vm.change($event.target.checked)}}}),_vm._v(" "),_c("span",{staticClass:"k-toggle-input-label",domProps:{"innerHTML":_vm._s(_vm.label)}})])])])])])};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());var b={extends:"k-info-section",components:{"k-sendmentions-details-dialog":g,"k-sendmentions-pagesettings":h,"k-sendmentions-pagesettingstoggle":j},props:{name:String,parent:String},data:function(){return{headline:null,settings:[],counter:[]}},created:function(){var e=this;console.log(this.$store),this.load().then(function(n){e.headline=n.headline,e.sendmentions=n.sendmentions,e.empty=n.empty,e.sendmentionsSystemErrors=n.sendmentionsSystemErrors,e.settings=n.pageSettings,e.pageid=n.pageId,e.counter=e.output(n.sendmentions)})},methods:{load:function(){return this.$api.get(this.parent+"/sections/"+this.name)},output:function(e){console.log(e);var n={mention:0,ping:0,none:0,notsent:0,archive:0};return Object.keys(e).forEach(function(t){"webmention"===e[t].type?n.mention++:"pingback"===e[t].type?n.ping++:"none"===e[t].type?n.none++:"archive.org"===e[t].type?n.archive++:"notsent"===e[t].type&&n.notsent++}),n},details:function(){this.$refs.details.open(this.sendmentions,this.empty)},changePageSetting:function(e,n){var t=this;return m(regeneratorRuntime.mark(function i(){var r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r="sendmentions/pagesettings/"+t.pageid.replace(/\//,"+"),i.next=3,t.$api.patch(r,{key:e,value:n});case 3:i.sent;case 4:case"end":return i.stop();}},i)}))()}}};if(typeof b==="function"){b=b.options}Object.assign(b,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("section",{staticClass:"k-sendmentions-section k-section"},[_c("header",{staticClass:"k-section-header"},[_c("k-headline",[_vm._v(_vm._s(_vm.headline))])],1),_vm._v(" "),_vm._l(_vm.sendmentionsSystemErrors,function(error){return _c("k-box",{key:error.id,attrs:{"theme":error.theme}},[_c("k-text",{attrs:{"size":"small"},domProps:{"innerHTML":_vm._s(error.message)}})],1)}),_vm._v(" "),_c("ul",{staticClass:"k-list"},[_c("li",{staticClass:"k-list-item",on:{"click":function($event){return _vm.details()}}},[_c("span",{staticClass:"k-list-item-text k-sendmentions-section-count"},[_c("em",[_c("svg",{attrs:{"viewBox":"0 0 16 16","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[_c("use",{attrs:{"xlink:href":"#icon-sendmentions-webmention"}})]),_vm._v(" "+_vm._s(_vm.counter.mention)+" ")]),_vm._v(" "),_c("em",[_c("svg",{attrs:{"viewBox":"0 0 16 16","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[_c("use",{attrs:{"xlink:href":"#icon-globe"}})]),_vm._v(" "+_vm._s(_vm.counter.ping)+" ")]),_vm._v(" "),_c("em",[_c("svg",{attrs:{"viewBox":"0 0 16 16","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[_c("use",{attrs:{"xlink:href":"#icon-cancel"}})]),_vm._v(" "+_vm._s(_vm.counter.none)+" ")]),_vm._v(" "),_c("em",[_c("svg",{attrs:{"viewBox":"0 0 16 16","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[_c("use",{attrs:{"xlink:href":"#icon-circle-outline"}})]),_vm._v(" "+_vm._s(_vm.counter.notsent)+" ")]),_vm._v(" "),_c("em",[_c("svg",{attrs:{"viewBox":"0 0 16 16","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[_c("use",{attrs:{"xlink:href":"#icon-sendmentions-archiveorg"}})]),_vm._v(" "+_vm._s(_vm.counter.archive)+" ")])]),_vm._v(" "),_c("nav",{staticClass:"k-list-item-options"},[_c("button",{staticClass:"k-button",attrs:{"type":"button"}},[_c("span",{staticClass:"k-button-icon k-icon k-icon-preview",attrs:{"aria-hidden":"true"}},[_c("svg",{attrs:{"viewBox":"0 0 16 16","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[_c("use",{attrs:{"xlink:href":"#icon-preview"}})])])])])])]),_vm._v(" "),_c("k-sendmentions-pagesettings",_vm._l(_vm.settings,function(setting){return _c("k-sendmentions-pagesettingstoggle",{key:setting.id,attrs:{"setting":setting},on:{"change":_vm.changePageSetting}})}),1),_vm._v(" "),_c("k-sendmentions-details-dialog",{ref:"details"})],2)};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());panel.plugin("sgkirby/sendmentions",{sections:{sendmentions:b,pings:b},icons:{"sendmentions-webmention":"<polygon fill-rule=\"nonzero\" points=\"9.23775281 14.8085393 7.34377528 9.01793258 7.31235955 9.01793258 5.45002247 14.8085393 2.96193258 14.8085393 0.00413483146 3.62759551 2.4611236 3.62759551 4.2294382 11.2382921 4.26067416 11.2382921 6.20139326 5.44750562 8.50202247 5.44750562 10.411191 11.3318652 10.4425618 11.3318652 11.8070562 5.45137079 10.0297079 5.44750562 13.7139775 2.02314607 16 5.45191011 14.189618 5.45078652 11.6785169 14.8085393\"></polygon>","sendmentions-archiveorg":"<path d=\"M15.5 1.8l-.3.5H.5l-.3-.5L8 0zm-.3 1H.5v1.4h14.7zm-1.8 7.7v1.3l.1 1.6.2.1q.6.2 1.3 0 .3-4.1 0-8.8-.8-.2-1.5 0v1.1l-.1 1v3.7zm-12.5.7v2.3H1.3l.2.1h1v-.1-.6l.1-1.9V9v-.8-.8-.8-.9-1H1v.8l-.1.2V11.2zm4 1.1v.7l.1.2v.3h.2l.1.1h1.1v-.1l.1-.6V11l.1-1V9 5.8l-.1-1H5L5 5v1.2l-.1.7v5.4zm6.2-6.8v-.7l-.4-.2-1 .1-.2 1.4V13l.1.6h.2l.2.1h1v-.1-.4l.1-.3v-2l.1-.8V9 7.8v-1-1.2zM.6 15h14.8V14H.6zM0 16h16v-.7H0z\"></path>"}});})();